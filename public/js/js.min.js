!function(e){ function t(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,t,n){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utils=t.ploc=t.localCache=t.lang=t.cookie=t.waitForFinalEvent=void 0;var o=n(1),a=function(){var e={};return function(t,n,o){o||(o="Don't call this twice without a uniqueId"),e[o]&&clearTimeout(e[o]),e[o]=setTimeout(t,n)}}(),i=document.domain,r=i.lastIndexOf("."),c=i.substr(r+1),l=i.substr(0,r);l.lastIndexOf(".")!=-1&&(l=l.substr(l.lastIndexOf(".")+1)),window.onerror=function(e,t,n,a){try{if(parseInt(n)>1&&t.indexOf("uptolike")==-1&&t.indexOf("bot")==-1&&t.indexOf("yandex")==-1&&t.indexOf("leechlink")==-1&&""!=t){if("undefined"==typeof i)var i=-1;var r="<i>"+(new Date).toString()+'</i><br><a href="'+window.location.href+'" target="_blank">'+window.location.href+"</a><br><b>id_auth</b>: "+i+"<br>"+navigator.userAgent+"<br>"+e+"<br><b>file</b>: "+t+"<b>line</b>: "+n+"<b>column</b>: "+a;$.get(o.ajax.ajaxFld+"/JsErrorHandler.php?jserror="+encodeURIComponent(r))}}catch(e){}};var u=new Date;u.setTime(u.getTime()+2592e6),u=u.toUTCString();var s={setCookie:function(e,t){document.cookie=e+"="+t+";expires="+u+";path=/;domain=."+l+"."+c},getCookie:function(e){return e=new RegExp(e+"=[^;]+","i"),document.cookie.match(e)?document.cookie.match(e)[0].split("=")[1]:null}},d=s.getCookie("lang"),p={timeout:1e4,data:{},remove:function(e){delete p.data[e]},exist:function(e){return!!p.data[e]&&(new Date).getTime()-p.data[e]._<p.timeout},get:function(e){return p.data[e].data},set:function(e,t,n){p.remove(e),p.data[e]={_:(new Date).getTime(),data:t},$.isFunction(n)&&n(t)}};$.ajaxPrefilter(function(e,t){e.cache&&!function(){var n=t.complete||$.noop,o=t.url;e.cache=!1,e.beforeSend=function(){return!p.exist(o)||(n(p.get(o)),!1)},e.complete=function(e){p.set(o,e,n)}}()});var m={info:function(e){"undefined"!=typeof console&&console.info(e)},dir:function(e){"undefined"!=typeof console&&console.dir(e)},table:function(e){"undefined"!=typeof console&&"undefined"!=typeof console.table&&console.table(e)},trim:function(e){var t=e.replace(/^ */,"");return t.replace(/ *$/,"")},floor:function(e,t){return Math.floor(e*Math.pow(10,t))/Math.pow(10,t)},winW:function(){return $(window).width()},winH:function(){return $(window).height()},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},isTouch:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch},getURLParam:function(e,t){return decodeURIComponent((t.match(new RegExp("[?|&]"+e+"=(.+?)(&|$)"))||[,null])[1])},endsWith:function(e,t){return e.indexOf(t,e.length-t.length)!==-1},isIE:function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)},getIEVer:function(){var e=9;return/MSIE (\d+\.\d+);/.test(navigator.userAgent)&&(e=Number(RegExp.$1)),e},getBrowserLang:function(){var e="ru";return"undefined"!=typeof navigator.language?e=navigator.language:"undefined"!=typeof navigator.browserLanguage?e=navigator.browserLanguage:"undefined"!=typeof navigator.systemLanguage?e=navigator.systemLanguage:"undefined"!=typeof navigator.userLanguage&&(e=navigator.userLanguage),e},isIE7:function(){return!!(m.isIE()&&m.getIEVer()<=7)},isIE8:function(){return!(!m.isIE()||8!=m.getIEVer())},rotateVal:function(e,t){if(e.length&&("int"==t||"float"==t)){var n=e.text();if(!(parseFloat(n)<=0)){var o="int"==t?parseInt(n):parseFloat(n),a=1;"int"==t&&o>10&&(a=o/10),"float"==t&&o>.1&&(a=o/10);var i=0,r=setInterval(function(){i<o?("int"==t?e.text(parseInt(i)):e.text(m.floor(i,2).toFixed(2)),i+=a):(e.text(n).addClass("animated bounceIn"),clearInterval(r))},100)}}},postForm:function(e,t,n){n=n||"post";var o=document.createElement("form");o.setAttribute("method",n),o.setAttribute("action",e);for(var a in t)if(t.hasOwnProperty(a)){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",a),i.setAttribute("value",t[a]),o.appendChild(i)}document.body.appendChild(o),o.submit()},handleHistory:function(e,t){var n=location.pathname.substr(0,location.pathname.lastIndexOf("/"));history.pushState&&history.replaceState&&!function(){$(document).on("click",e,function(e){"undefined"!==$(this)[0].id&&("prevLnkKey"==$(this)[0].id?s.setCookie("nav_dir","prev"):"nextLnkKey"==$(this)[0].id&&s.setCookie("nav_dir","next"));var a=this.href;a!=location.href&&(a=a.substr(a.lastIndexOf("/")),window.history.pushState(null,"",n+a),o.ajax.handelAjax(n+t+a)),e.preventDefault()});var a="state"in window.history,i=location.href;$(window).bind("popstate",function(){var e=!a&&location.href==i;if(a=!0,!e){var r=location.href;r=r.substr(r.lastIndexOf("/")),o.ajax.handelAjax(n+t+r)}})}()}},f=5,h=3e4,g={by:{already_rec_note_loc:"Спасибо, ваша<br />рекомендация принята",be_constructive_loc:"Текст сообщения должен содержать хотя бы "+f+" букв",max_comm_len_loc:"Сообщение должно содержать не более "+h+" символов",really_do_home_album_loc:"Вы действительно считаете, что эта работа\nне должна присутствовать в галерее?",loc:""},en:{already_rec_note_loc:"Thanks, your<br />recommendation is received",be_constructive_loc:"Please write some words",max_comm_len_loc:"Max "+h+" characters",really_do_home_album_loc:"Do you really want that this work will be deleted from the gallery?",loc:""},de:{already_rec_note_loc:"Danke, Ihre Empfehlung<br />wurde gezählt",be_constructive_loc:"Ihre Anmerkung soll mindestens "+f+" Buchstaben enthalten",max_comm_len_loc:"Eine Anmerkung darf bis zu "+h+" Zeichen enthalten",really_do_home_album_loc:"Möchten Sie wirklich, dass dieses Bild von der Bildergalerie entfernt wird?",loc:""},ru:{already_rec_note_loc:"Рекомендация<br />принята",be_constructive_loc:"Текст сообщения должен содержать хотя бы "+f+" букв",max_comm_len_loc:"Сообщение должно содержать не более "+h+" символов",really_do_home_album_loc:"Вы действительно считаете, что эта работа\nне должна присутствовать в галерее?",loc:""}};"by"==d?t.ploc=g=g.by:"en"==d?t.ploc=g=g.en:"de"==d?t.ploc=g=g.de:t.ploc=g=g.ru,t.waitForFinalEvent=a,t.cookie=s,t.lang=d,t.localCache=p,t.ploc=g,t.utils=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ajax=void 0;var o=n(0),a=n(2),i={ajaxFld:"/ajax",loader:'<img src="/css/black/loader_gray.new.gif" alt="">',handelAjax:function(e){function t(t){t.responseJSON=t.responseJSON||!1,t.responseJSON&&!jQuery.isEmptyObject(t.responseJSON)?(t=t.responseJSON,t.ajaxBody=t.ajaxBody||"",t.title=t.title||"",t.debug=t.debug||"",t.canonicalUrl=t.canonicalUrl||"",t.hrefPrev=t.hrefPrev.replace(/&amp;/g,"&")||"",t.hrefNext=t.hrefNext.replace(/&amp;/g,"&")||"",n.html(t.ajaxBody),a.app.isFirstClick&&o.utils.isMobile()||n.addClass("animated fadeIn"),a.app.isFirstClick=!1,""!=t.title&&(document.title=t.title),$("link[rel='canonical']").attr("href",t.canonicalUrl),$("#canonicalUrl").attr("href",t.canonicalUrl),$(".prevLnk").attr("href",t.hrefPrev),$(".nextLnk").attr("href",t.hrefNext),$("#debug").html(t.debug),a.app.updateMainImg(),l||i.getViews(),"function"==typeof ga&&ga("send","pageview",{page:e.replace(/\/ajax/,""),title:document.title})):t.responseText.match(/Location: /)&&(window.location.href=t.responseText.replace(/Location: /,"")),$("#ajax_overlay").remove(),a.app.isInZoom=!1}$("html, body").animate({scrollTop:0},300),$("#submenu").slideUp(),a.app.removeCrop();var n=$("#ajaxBody"),r=n.offset(),c={w:n.width(),h:n.height()};$("#ajax_overlay").length||(n.removeClass("animated fadeIn"),$('<div id="ajax_overlay"></div>').css({left:r.left+"px",top:r.top+"px",width:c.w+"px",height:c.h+"px"}).appendTo("body"),setTimeout(function(){$("#ajax_overlay").addClass("loader")},500));var l=!1;o.localCache.exist(e)&&(l=!0),$.ajax({url:e,cache:!0,complete:t})},postComm:function(){var e=$("#mainImage").data("idPhoto"),t=$("#commText"),n=o.utils.trim(t.val());n.length<minCommLen?(alert(o.ploc.be_constructive_loc),t.focus()):n.length>3e4?(alert(o.ploc.max_comm_len_loc),t.focus()):!function(){var o=$("#loaderComm");o.show(),$.post("/ajax/post_comm.php",{id:e,comm_text:n,type:"work",id_auth_answer:0,id_comm_parent:0},function(e){e.cnt=e.cnt||1;var a=$("#submenu");$("#commTbl").find("tbody").append('<tr><td class="commAuth"><a href="'+a.data("authUrl")+'"><img src="'+a.data("authAvatar")+'"></a></td><td class="commTextTd"><div class="commText"><a href="'+a.data("authUrl")+'">'+a.data("authName")+"</a><br>"+n+"</div></td></tr>"),t.val(""),o.hide()},"json")}()},getRecs:function(){var e=$("#mainImage").data("idPhoto");$("#addRecAjax").html('<span class="recNote">'+o.ploc.already_rec_note_loc+"</span>"),$("#homeAlbumAjax").hide();var t=$("#phRating"),n=t.text();t.text();var a=!1;setTimeout(function(){a||t.html(i.loader)},500),$.get("/ajax/get_recs.php",{id_photo:e},function(e){a=!0,t.text(o.utils.floor(parseFloat(n)+parseFloat(e),2)).addClass("animated bounceIn")})},getFineart:function(){var e=$("#mainImage").data("idPhoto"),t=$("#fineartBtn").data("fineart");$("#fineartAjax").text(""),$.get("/ajax/get_fineart.php",{id:e,fineart:t},function(e){})},getHomeAlbum:function(){var e=$("#mainImage").data("idPhoto");$("#homeAlbumAjax").hide(),$.get("/ajax/get_home_album.php",{id_photo:e,is_vote:1},function(e){})},getViews:function(){var e=$("#mainImage");e.length&&$.get("/ajax/get_views.php",{id:e.data("idPhoto")},function(e){})},getFollow:function(e){var t=$("#ajaxHeader").data("idAuthPhoto"),n=$("#followBtnBlk"),o=!1;setTimeout(function(){o||n.html(i.loader)},500),$.get("/ajax/get_follow.php",{id:t,act:e,type:"auth"},function(e){o=!0,n.html(e+"<br>&nbsp;")})}};t.ajax=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=void 0;var o=n(0),a={winW:$(window).width(),winH:$(window).height(),isCrop:!1,cropX:0,cropY:0,cropW:0,cropH:0,viewedNudes:[],isFirstClick:!0,isInZoom:!1,clickDelay:200,clicksCnt:0,clickTimer:0,toggleCrop:function(){if(a.resetImgZoom(),a.cropW>0&&a.cropH>0){if(a.isCrop)$(".crop_overlay_dark").remove(),$(".crop_overlay_light").remove();else{$("html, body").animate({scrollTop:0},300);var e=$("#mainImage");if("nudePreview"==e.attr("class"))"undefined"==typeof e.data("isAllowedNude")&&a.showNude();else{var t=e.offset(),n={w:e.width(),h:e.height()},o=n.w/parseInt(e.data("phMainW")),i=n.h/parseInt(e.data("phMainH"));$('<div class="crop_overlay_dark"></div>').css({left:t.left+"px",top:t.top+"px",width:n.w+.1+"px",height:n.h+.1+"px"}).appendTo("body"),$('<div class="crop_overlay_light" style="background: transparent url('+e.attr("src")+") no-repeat -"+a.cropX*o+"px -"+a.cropY*i+"px; background-size: "+n.w+"px "+n.h+'px;"></div>').css({left:t.left+a.cropX*o+"px",top:t.top+a.cropY*i+"px",width:a.cropW*o+"px",height:a.cropH*i+"px"}).appendTo("body")}}a.isCrop=!a.isCrop}},removeCrop:function(){$(".crop_overlay_dark").remove(),$(".crop_overlay_light").remove(),a.isCrop=!1},showNude:function(){var e=$("#mainImage");return!!e.length&&(e.removeClass("nudePreview").addClass("animated fadeIn"),e.attr("src",e.data("phPath")+e.data("idPhoto")+"_mobile.jpg").css({width:"auto",height:"auto"}),a.updateMainImg(),a.viewedNudes.push(e.data("idPhoto")),!0)},updateMainImg:function(){var e=$("#mainImage"),t=$("#nudeWarn");if(e.length){if("nudePreview"==e.attr("class"))for(var n=0;n<a.viewedNudes.length;n++)if(e.data("idPhoto")==a.viewedNudes[n]){e.removeClass("nudePreview"),e.attr("src",e.data("phPath")+e.data("idPhoto")+"_mobile.jpg").css({width:"auto",height:"auto"});break}var o=e.attr("src"),i="main";if("undefined"!=typeof e.data("isAllowedNude")&&(i="council"),a.winW>=420){var r=$("#mobileImage");r.attr("src",o.replace(/mobile/g,i)),r.waitForImages(function(){e.attr("src",o.replace(/mobile/g,i))});var c=e.data("phMainW"),l=e.data("phMainH");c>a.winW&&(console.log(a.winW),l=l/c*a.winW,c=a.winW),e.css({width:c+"px",height:l+"px"}),t.css({"margin-top":+(l/2-15)+"px"})}else e.attr("src",o.replace(new RegExp(i,"g"),"mobile"));a.resetImgZoom(),a.fixCommText()}},resetImgZoom:function(){if(!a.isInZoom)return!0;var e=$("#mainImage");a.isInZoom=!1,e.panzoom("reset",{duration:500}),setTimeout(function(){e.panzoom("destroy")},500)},handleImgZoom:function(){if(!o.utils.isTouch()||a.isCrop)return!0;if(a.isInZoom)a.resetImgZoom();else{var e=$("#mainImage");a.winW<420&&e.attr("src",e.attr("src").replace(/mobile/g,"main"));var t=e.data("phMainW")/e.width();if(t<=1)return!0;a.isInZoom=!0,e.panzoom({minScale:t,maxScale:t,duration:500,contain:"invert"}),e.panzoom("zoom")}},submitLogin:function(){var e=o.utils.trim($("#auth_login").val()),t=o.utils.trim($("#auth_pass").val());if(""!=e&&""!=t){var n=location.href.replace(/&wrn_login=1/,"");""!=window.location.search||o.utils.endsWith(n,"?")||(n+="?"),o.utils.postForm(n,{auth_login:encodeURI(e),auth_pass:encodeURI(t)})}},emoticon:function(e){var t=$("#commText"),n=t.val();o.utils.trim(n)&&(n+="\n"),n+="[b]"+$("#authName"+e).text()+"[/b], ",t.focus().val("").val(n).css({height:"100px"})},fixCommText:function(){a.winW<400&&$(".commText").css({width:a.winW-60+"px"})},fixLayout:function(){a.winW=o.utils.winW(),a.winH=o.utils.winH(),o.utils.info("winW: "+a.winW+", winH: "+a.winH),a.updateMainImg(),a.removeCrop()}};t.app=a},function(e,t,n){"use strict";n(5)},function(e,t,n){"use strict";var o=n(0),a=n(1),i=n(2);$(function(){o.utils.handleHistory('a[rel="prev"], a[rel="next"], a[rel="author"]',a.ajax.ajaxFld),$(window).resize(function(){(0,o.waitForFinalEvent)(function(){i.app.fixLayout()},500,"delayed_resize")}),$(document).on("keyup","#auth_login, #auth_pass",function(e){13==e.keyCode&&(i.app.submitLogin(),e.preventDefault())}).on("click","#loginBtn",function(e){i.app.submitLogin(),e.preventDefault()}).on("click","#menuLnk",function(){i.app.removeCrop(),$("#submenu").slideToggle(200,function(){})}).on("click",".crop_overlay_dark, .crop_overlay_light",function(){i.app.removeCrop()}).on("click","#addRecBtn",function(e){a.ajax.getRecs(),e.preventDefault()}).on("click","#fineartBtn",function(e){a.ajax.getFineart(),e.preventDefault()}).on("click","#homeAlbumBtn",function(e){confirm(o.ploc.really_do_home_album_loc)&&a.ajax.getHomeAlbum(),e.preventDefault()}).on("click","#addCommBtn",function(e){a.ajax.postComm(),e.preventDefault()}).on("click","#followBtn, #unfollowBtn",function(e){"followBtn"==$(this).attr("id")?a.ajax.getFollow(1):a.ajax.getFollow(0),e.preventDefault()}).on("click",".nudePreview",function(e){"undefined"==typeof $(this).data("isAllowedNude")&&i.app.showNude()&&(e.stopPropagation(),e.preventDefault())}).on("click",".authNameAnswer",function(e){i.app.emoticon($(this).data("idAuth")),e.stopPropagation(),e.preventDefault()}).on("click",".cropClick",function(e){var t=$(this).data("cropCoordinates").split(";");4==t.length&&(i.app.cropX=t[0],i.app.cropY=t[1],i.app.cropW=t[2],i.app.cropH=t[3],i.app.toggleCrop()),e.stopPropagation(),e.preventDefault()}).on("click","#canonicalUrl",function(){o.cookie.setCookie("allowFullVer",1)}).on("click","#commText",function(){$(this).css({height:"100px"})}).on("doubletap","#mainImageA",function(e){i.app.handleImgZoom(),e.preventDefault()}).on("dblclick","#mainImageA",function(e){e.preventDefault()}).on("click","#mainImageA",function(e){i.app.clicksCnt++,1===i.app.clicksCnt?i.app.clickTimer=setTimeout(function(){i.app.clicksCnt=0,i.app.isInZoom||$("#nextLnkKey").trigger("click"),e.preventDefault()},i.app.clickDelay):(clearTimeout(i.app.clickTimer),i.app.handleImgZoom(),e.preventDefault(),i.app.clicksCnt=0)}).on("click","#facebookBtn",function(){$(this).attr("disabled",!0)}).on("keyup",function(e){39==e.keyCode?$("#nextLnkKey").click():37==e.keyCode&&$("#prevLnkKey").click(),e.preventDefault()}),setTimeout(function(){$("#resultMsg").slideUp()},3e3),i.app.updateMainImg(),a.ajax.getViews(),o.utils.rotateVal($("#authRating"),"float")})},function(e,t){},function(e,t,n){n(4),e.exports=n(3)}]);